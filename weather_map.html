<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Weather App</title>
	<script src="js/jquery.js"></script>
	<script src="js/keys.js"></script>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
	      integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">

</head>
<body>
<div class="container">
	<div class="row">
		<h1>Your local weather</h1>
	</div>
	<div class="row">
<!--		current weather-->
	</div>
	<div class="row" id="insert">

	</div>
</div>
</body>
<script>

	let print = [];
	$.get("http://api.openweathermap.org/data/2.5/forecast?", {
		APPID: weatherMapKey,
		q:     "City of Salem, US",
		units: 'imperial'
	}).done(function (data) {
		let maxTemp = 0;
		let lowTemp = 0;
		let date = ``;
		let periodsOfRain = [];
		let mainWordCounter = [0,0,0,0,0,0];
		let mainWordArr = [`Clear`,`Cloud`,`Snow`,`Rain`,`Drizzle`,`Thunderstorms`]
		let weather = {};
		let tempTime = ``;
		for (let i = 0; i < data.list.length; i++) {
			let temp = data.list[i].dt_txt.split(` `);
			let dateCompare = temp[0];
			if (i === 0) {
				date = dateCompare;
				maxTemp = data.list[i].main.temp_max;
				lowTemp = data.list[i].main.temp_min;
			}
			if (dateCompare !== date || i === (data.list.length-1) ) {
				weather.date = date;
				weather.max = maxTemp;
				weather.low = lowTemp;
				weather.rainPeriods = periodsOfRain;
				const max = Math.max(...mainWordCounter);
				const index = mainWordCounter.indexOf(max);
				let word = mainWordArr[index];
				if (index === 0){
					word = word + ` Sky's`;
				}
				else if (index === 1 || index === 3){
					word = word + `y`
				}
				if (mainWordCounter[3] >= 2){
					weather.main = word + ` with periods of rain`;
				}
				else {
					weather.main = word;
				}
				print.push(weather);
				weather = {};
				date = dateCompare;
				maxTemp = data.list[i].main.temp_max;
				lowTemp = data.list[i].main.temp_min;
				periodsOfRain = [];
				mainWordCounter = [0,0,0,0,0,0];
			}
			else {
				if(data.list[i].main.temp_max > maxTemp){
					maxTemp = data.list[i].main.temp_max;
				}
				if(data.list[i].main.temp_min < lowTemp){
					lowTemp = data.list[i].main.temp_min;
				}
				if (data.list[i].weather[0].main.includes(`Rain`)){
					 tempTime = data.list[i].dt_txt.split(` `);
					periodsOfRain.push(tempTime[1]);
				}
			}
			if (data.list[i].weather[0].main.includes(mainWordArr[0])){
				mainWordCounter[0] ++;
			}
			else if (data.list[i].weather[0].main.includes(mainWordArr[1])){
				mainWordCounter[1] ++;
			}
			else if (data.list[i].weather[0].main.includes(mainWordArr[2])){
				mainWordCounter[2] ++;
			}
			else if (data.list[i].weather[0].main.includes(mainWordArr[3])){
				mainWordCounter[3] ++;
			}
			else if (data.list[i].weather[0].main.includes(mainWordArr[4])){
				mainWordCounter[4] ++;
			}
			else if (data.list[i].weather[0].main.includes(mainWordArr[5])){
				mainWordCounter[5] ++;
			}
		}
		console.log(print);
	});




//#TODO :: look at example and get what you need, we now can get what we want



</script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js"
        integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk"
        crossorigin="anonymous"></script>

</html>